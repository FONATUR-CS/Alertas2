<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestor Fonatur - Comunicación Social</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #05110e;
        color: #f3f4f6;
      }
      .font-news {
        font-family: "Playfair Display", serif;
      }
      .hidden {
        display: none !important;
      }
      .progress-bar {
        height: 6px;
        background: #bd9751;
        width: 0%;
        transition: width 0.3s;
        box-shadow: 0 0 10px #bd9751;
      }
    </style>
    <script type="importmap">
      {
        "imports": {
          "@google/generative-ai": "https://esm.sh/@google/generative-ai@0.21.0"
        }
      }
    </script>
  </head>
  <body class="min-h-screen flex overflow-hidden">
    <aside
      class="w-80 bg-[#0b231e] border-r border-[#1a3d35] flex flex-col hidden lg:flex"
    >
      <div
        class="p-6 border-b border-[#1a3d35] flex justify-between items-center text-[#bd9751]"
      >
        <h2 class="font-bold uppercase text-xs">Historial</h2>
        <button id="btn-clear-history">
          <i data-lucide="trash-2" class="w-4 h-4"></i>
        </button>
      </div>
      <div id="history-list" class="flex-1 overflow-y-auto p-4 space-y-2">
        <div id="history-empty" class="text-center py-10 text-gray-600 text-sm">
          Sin alertas
        </div>
      </div>
    </aside>

    <main class="flex-1 flex flex-col h-screen">
      <header
        class="h-24 flex items-center justify-between px-8 border-b border-[#1a3d35] bg-[#0b231e]"
      >
        <div class="flex items-center gap-4">
          <div
            class="w-10 h-10 bg-[#bd9751] rounded flex items-center justify-center"
          >
            <i data-lucide="shield-check" class="text-[#0b231e]"></i>
          </div>
          <div>
            <h1 class="text-lg font-bold uppercase text-white">
              FONATUR <span class="text-[#bd9751]">Alertas</span>
            </h1>
            <p
              class="text-[9px] text-[#bd9751] font-bold uppercase tracking-widest"
            >
              Comunicación Social
            </p>
          </div>
        </div>
        <div class="flex items-center gap-3">
          <button id="btn-training" class="p-2 text-gray-400 hover:text-white">
            <i data-lucide="book-open" class="w-5 h-5"></i>
          </button>
          <button id="btn-settings" class="p-2 text-gray-400 hover:text-white">
            <i data-lucide="key" class="w-5 h-5"></i>
          </button>
          <button
            id="btn-record"
            class="bg-white text-[#0b231e] px-4 py-2 rounded font-bold text-xs uppercase"
          >
            Grabar
          </button>
          <button
            id="btn-stop"
            class="hidden bg-red-600 text-white px-4 py-2 rounded font-bold text-xs animate-pulse"
          >
            Detener
          </button>
          <label
            class="cursor-pointer bg-[#13322b] p-2 rounded border border-[#bd9751]/30 text-[#bd9751]"
          >
            <i data-lucide="upload" class="w-5 h-5"></i>
            <input
              type="file"
              id="file-input"
              class="hidden"
              accept="audio/*,video/*"
            />
          </label>
        </div>
      </header>

      <div class="flex-1 overflow-y-auto p-8 flex flex-col items-center">
        <div
          id="error-banner"
          class="hidden w-full max-w-2xl bg-red-900/50 border border-red-500 p-4 rounded mb-6 text-red-200 flex gap-2"
        >
          <i data-lucide="alert-circle"></i>
          <p id="error-message" class="text-sm"></p>
        </div>

        <div id="empty-state" class="py-32 text-center">
          <h2 class="text-2xl font-news italic opacity-80">
            Buzón Institucional
          </h2>
          <p class="text-gray-500 text-sm mt-2">
            Cargue un reporte para procesar la alerta.
          </p>
        </div>

        <div
          id="loading-state"
          class="hidden w-full max-w-sm py-20 text-center"
        >
          <div
            class="w-12 h-12 border-4 border-[#bd9751]/20 border-t-[#bd9751] rounded-full animate-spin mx-auto mb-6"
          ></div>
          <div class="w-full bg-gray-800 rounded-full h-1.5">
            <div id="progress-bar" class="progress-bar"></div>
          </div>
          <p
            id="progress-status"
            class="text-[10px] text-[#bd9751] font-bold uppercase mt-2"
          >
            Iniciando análisis...
          </p>
        </div>

        <div
          id="result-container"
          class="hidden w-full max-w-4xl bg-white text-[#0b231e] rounded shadow-2xl overflow-hidden flex flex-col mb-10"
        >
          <div
            class="bg-gray-100 px-6 py-3 border-b flex justify-between items-center"
          >
            <span
              class="text-[9px] font-bold uppercase tracking-widest text-gray-500"
              >FONATUR • Comunicación Social</span
            >
            <button
              id="btn-copy"
              class="bg-[#0b231e] text-white px-3 py-1.5 rounded text-[10px] font-bold uppercase"
            >
              Copiar
            </button>
          </div>
          <div
            class="p-10 font-news text-lg leading-relaxed whitespace-pre-wrap"
          >
            <div id="alert-content"></div>
          </div>
        </div>
      </div>
    </main>

    <div
      id="api-modal"
      class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"
    >
      <div
        class="bg-[#0b231e] border border-[#1a3d35] p-6 rounded-lg w-full max-w-xs"
      >
        <h3 class="text-[#bd9751] font-bold mb-4 text-xs uppercase">API Key</h3>
        <input
          type="password"
          id="api-key-input"
          class="w-full bg-black border border-gray-700 p-3 rounded text-sm text-white mb-4 outline-none"
        />
        <button
          id="btn-save-key"
          class="w-full bg-[#bd9751] text-black py-2 rounded font-bold text-xs uppercase"
        >
          Guardar
        </button>
      </div>
    </div>

    <div
      id="training-modal"
      class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"
    >
      <div
        class="bg-[#0b231e] border border-[#1a3d35] p-6 rounded-lg w-full max-w-xl h-3/4 flex flex-col"
      >
        <h3 class="text-[#bd9751] font-bold mb-4 text-xs uppercase">
          Estilo de Referencia
        </h3>
        <textarea
          id="training-input"
          class="flex-1 bg-black border border-gray-700 p-4 rounded text-xs text-gray-300 font-mono resize-none"
        ></textarea>
        <button
          id="btn-save-training"
          class="w-full bg-[#bd9751] text-black py-2 rounded font-bold text-xs uppercase mt-4"
        >
          Guardar
        </button>
      </div>
    </div>

    <script type="module" src="./index.js"></script>
  </body>
</html>
